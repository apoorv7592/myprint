function update_stars(){$(".star_rating_form").each(function(){var a=$(this).attr("id");set_stars(a,$("#"+a+"_stars").val())})}function set_stars(a,t){for(i=1;5>=i;i++)t>=i?$("#"+a+"_"+i).addClass("on"):$("#"+a+"_"+i).removeClass("on")}$(function(){$(".rating_star").click(function(){var a=$(this),t=a.attr("data-form-id"),s=a.attr("data-stars");$("#"+t+"_stars").val(s),$.ajax({type:"post",url:$("#"+t).attr("action")+".json",data:$("#"+t).serialize(),success:function(a){console.log(a),update_stars(),a.avg_rating&&$("#average_rating").text(a.avg_rating)}})})});